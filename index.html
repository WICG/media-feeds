<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Media Feeds</title>
  <script src="https://www.w3.org/Tools/respec/respec-w3c" class="remove"></script>
  <script class='remove'>
  "use strict";
  // See https://github.com/w3c/respec/wiki/ for how to configure ReSpec
  var respecConfig = {
    "github": "WICG/media-feeds",
    "editors": [{
        name: "Becca Hughes",
        email: "beccahughes@chromium.org",
        company: "Google LLC",
        w3cid: 103353
      },
      // Add additional editors here. https://github.com/w3c/respec/wiki/editors
    ],
    "shortName": "media-feeds",
    "specStatus": "CG-DRAFT",
    "wg": "WICG",
    "wgURI": "https://www.w3.org/community/wicg/"
  };
  </script>
</head>

<body>
  <section id="abstract">
    <p>
      This specification enables web developers to show personalized media
      recommendations on the browser UI.
    </p>
  </section>
  <section id="sotd">
    <p>
      This is an unofficial proposal.
    </p>
  </section>
  <section id="introduction">
    <h2>Introduction</h2>
    <p>
      <em>This section is non-normative.</em>
    </p>

    <p>
      Media is used extensively today, and the Web is one of the primary means
      of consuming media content. Many browsers show content recommendations in
      their UI. This specification aims to enable web sites to specify a feed of
      personalized media recommendations that can be fetched by the browser and
      displayed in the browser UI. By improving media discovery this would
      improve the user experience as well as providing web sites with a new way
      of reaching users.
    </p>
  </section>

  <section id="conformance">
    <p>
      Unless otherwise stated, string comparisons are done in a
      <a data-cite="HTML#case-sensitive">case-sensitive</a> manner.
    </p>

    <p>
      In this document when we compare a string that starts with or equals
      <code>https://schema.org</code> then <code>http://schema.org</code> is
      valid too.
    </p>
  </section>

  <section id="security-privacy-considerations">
    <h2>Security and Privacy Considerations</h2>
    <p>
      <em>This section is non-normative.</em>
    </p>

    <p>
      The API introduced in this specification has very low impact with regards
      to security and privacy. The user agent should take care of fetching feeds
      based on heuristics. The site may also be able to see when their feed
      content is clicked by adding tracking to the <a>media feed item url</a> or
      to the <a>media image</a> url.
    </p>

    <p>
      For privacy purposes, the user agent should disable the feature in incognito
      mode. This is because the lifetime of the incognito mode session is not long
      enough for this feature to be useful.
    </p>

    <p>
      In order to not show a stale <a>currently logged in user</a>, the user agent
      should invalidate the contents of a feed in the following cases:

      <ul>
        <li>
          The user visits the website.
        </li>
        <li>
          If there is a <a>cookie name filter</a> that matches the name of a cookie on the
          website and that cookie's value changed.
        </li>
        <li>
          If there is no <a>cookie name filter</a>, then when any cookie expires or is
          deleted on the website.
        </li>
      </ul>

      When the feed is invalidated it should clear the contents and trigger a fetch
      the next time the user agent fetches the feeds.
    </p>

    <p>
      A <dfn>cookie name filter</dfn> is the name of a cookie that signals the user
      agent to invalidate the contents of the feed. It is intended for the website
      to provide the name of the login cookie so the user agent can invalidate the
      feed if the login session changes.
    </p>

    <p>
      Periodic background fetching of media feeds carries the risk of exposing the
      list of the user's top media sites to network observers on any network the user
      connects to in the future. Therefore, the user agent MUST obtain consent for
      this feature.
    </p>
  </section>

  <section id="model">
    <h2>Model</h2>

    <p>
      The <dfn>media feed store</dfn> stores media feeds that have been
      discovered. There can only be one <a>media feed URL</a>
      <a data-cite="HTML#concept-origin">per-origin</a>. If a user agent
      discovers a new <a>media feed URL</a> for an
      <a data-cite="HTML#concept-origin">origin</a> that already has a <a>media
      feed URL</a> then we will replace the existing one.
    </p>
  </section>

  <section id="discovery-of-media-feeds">
    <h2>Discovery of Media Feeds</h2>

    <p>
      The site should advertise the Media Feed to the user agent by adding a
      <a data-cite="HTML#link">link element</a> to the
      <a data-cite="HTML#the-head-element">head element</a>, these are known as
      the <dfn>eligible feed links</dfn>. The
      <a data-cite="HTML#attr-hyperlink-href">href attribute</a> contains the
      <dfn>media feed URL</dfn>.
    </p>

    <p>
      Media Feeds are only discovered on top-level
      <a data-cite="HTML#document">Documents</a> that are a
      <a data-cite="secure-contexts#secure-context">secure context</a>.
    </p>

    <p>
      The user agent MUST run the following steps for each <a>eligible feed link
      </a> when the <a data-cite="HTML#document">Document</a> is
      <a data-cite="HTML#ready-for-post-load-tasks">ready for post-load tasks</a>:

      <ul>
        <li>
          If the <a data-cite="HTML#linkTypes">link type</a> is not set to
          <code>media-feed</code> then return null
        </li>
        <li>
          If the <a>media feed URL</a> is not a valid
          <a data-cite="url#urls">URL</a> then return an error
        </li>
        <li>
          If the <a>media feed URL</a> is not the
          <a data-cite="HTML#concept-origin">same origin</a> as the current
          document then return an error
        </li>
        <li>
          Store the <a>media feed URL</a> and
          <a data-cite="HTML#concept-origin">origin</a> in the
          <a>media feed store</a>
        </li>
      </ul>
    </p>
  </section>

  <section id="retrieval-of-media-feeds">
    <h2>Retrieval of Media Feeds</h2>

    <p>
      The user agent MUST initiate a <a data-cite="FETCH#fetching">fetch</a>
      with the following <a data-cite="FETCH#concept-request">request</a>
      parameters:

      <ul>
        <li>
          <a data-cite="FETCH#concept-header-list">header list</a>
          containing the <a data-cite="rfc7231#header.accept">accept header</a> set
          to <a data-cite="json-ld11#iana-considerations">application/ld+json</a>
        </li>
        <li>
          <a data-cite="FETCH#concept-request-redirect-mode">redirect mode</a> set to
          <code>error</code>
        </li>
      </ul>
    </p>

    <p>
      The site will return the <dfn>media feed document</dfn> which MUST be
      valid <a data-cite="JSON#">JSON</a>. The feed uses a restricted subset of
      <a data-cite="json-ld11#">JSON+LD</a> as specified in this spec. This
      results in the feed being compatible with <a data-cite="json-ld11#">JSON+LD</a>
      but not the other way around.
    </p>

    <p>
      If the user agent recieves a
      <a data-cite="rfc7231#section-6.5.9">410 Gone</a> status code from the
      site then it should remove the feed from the <a>media feed store</a>.
    </p>

    <section id="media-feed-document">
      <h3>Media Feed Document</h2>

      <p>
        The <a>media feed document</a> should be a
        <a data-cite="schema-org/CompleteDataFeed#">CompleteDataFeed</a>. This
        has a <a data-cite="schema-org/provider#">provider</a> property that
        contains an <a data-cite="schema-org/Organization#">Organization</a> to
        describe the <dfn>publishing web site</dfn>. The
        <a data-cite="schema-org/member#">member</a> field on
        <a data-cite="schema-org/Organization#">Organization</a> should
        contain a <a data-cite="schema-org/Person#">Person</a> that contains the
        details about the <dfn>currently logged in user</dfn>. The user agent can
        show this to the user to identifier which account the recommendations are
        coming from. This is especially important if the media site supports
        multiple profiles.
      </p>

      <p>
        The user agent MUST validate the <a>media feed document</a> using the
        following steps:

        <ul>
          <li>
            The <a data-cite="json-ld11#the-context">context</a> MUST be set to
            <code>https://schema.org</code>.
          </li>
          <li>
            The <a data-cite="json-ld11#specifying-the-type">type</a> MUST be
            set to
            <a data-cite="schema-org/CompleteDataFeed#">CompleteDataFeed</a>.
          </li>
          <li>
            The <a data-cite="schema-org/member#">provider</a> property MUST
            contain a <a data-cite="schema-org/Organization#">Organization</a>
            that is a valid <a>publishing web site</a>.
          </li>
          <li>
            The <a data-cite="schema-org/dataFeedElement#">dataFeedElement</a>
            property supports <a>multiple values</a> and if present it MUST
            contain valid <a>media feed items</a> or
            <a>media feed broadcast events</a>.
          </li>
          <li>
            The <a data-cite="schema-org/additionalProperty#">additionalProperty</a>
            property supports <a>multiple values</a> and if present it MUST
            contain valid <a>media feed properties</a>.
          </li>
        </ul>
      </p>

      <p>
        The user agent MUST validate the <dfn>media feed property</dfn> using the
        following steps:

        <ul>
          <li>
            The <a data-cite="json-ld11#specifying-the-type">type</a> MUST be
            set to <a data-cite="schema-org/PropertyValue#">PropertyValue</a>.
          </li>
          <li>
            The <a data-cite="schema-org/name#">name</a> property MUST be present
            and contain a valid non-empty string.
          </li>
          <li>
            The <a data-cite="schema-org/value#">value</a> property MUST be present
          </li>
          <li>
            If the name <a data-cite="schema-org/name#">name</a> property contains
            <code>cookieNameFilter</code> then the user agent MUST run the following
            steps:

            <ul>
              <li>
                The <a data-cite="schema-org/value#">value</a> property MUST contain
                a valid non-empty string that will be set as the
                <a>cookie name filter</a>.
              </li>
            </ul>
          </li>
        </ul>
      </p>

      <p>
        The user agent MUST validate the <a>publishing web site</a> using the
        following steps:

        <ul>
          <li>
            The <a data-cite="json-ld11#specifying-the-type">type</a> MUST be
            set to <a data-cite="schema-org/Organization#">Organization</a>.
          </li>
          <li>
            The <a data-cite="schema-org/name#">name</a> property MUST contain a
            valid non-empty string.
          </li>
          <li>
            The <a data-cite="schema-org/logo#">logo</a> property supports
            <a>multiple values</a> and MUST contain a maximum of 5 different
            <a>media logos</a>.
          </li>
          <li>
            The <a data-cite="schema-org/member#">member</a> property is
            optional. If present, it MUST contain a valid
            <a>currently logged in user</a>.
          </li>
        </ul>
      </p>

      <p>
        The user agent MUST validate the <a>currently logged in user</a> using
        the following steps:

        <ul>
          <li>
            The <a data-cite="json-ld11#specifying-the-type">type</a> MUST be
            set to <a data-cite="schema-org/Person#">Person</a>.
          </li>
          <li>
            The <a data-cite="schema-org/name#">name</a> property MUST contain a
            valid non-empty string.
          </li>
          <li>
            The <a data-cite="schema-org/image#">image</a> property is optional.
            If present, it MUST contain a valid <a>media image</a>.
          </li>
          <li>
            The <a data-cite="schema-org/email#">email</a> property is optional.
            If present, it MUST contain a valid
            <a data-cite="EMAIL#section-3.4">email address</a>.
          </li>
        </ul>
      </p>

      <div class="example" id="example-1-sample-feed">
        <div class="marker">
            <a class="self-link" href="#example-1-sample-feed">
              Example<bdi> 1</bdi>
            </a>
            <span class="example-title">: Sample Media Feed</span>
        </div>
        <pre>
          <code class="json">
            {
              "@context": "http://schema.org",
              "@type": "CompleteDataFeed",
              "dataFeedElement": [
                ...
              ]
              "provider": {
                "@type": "Organization",
                "member": {
                  "@type": "Person",
                  "email": "beccahughes@chromium.org",
                  "name": "Becca Hughes",
                  "image": "https://www.example.org/profile_pic.jpg"
                },
                "name": "Media Site",
                "logo": [
                  {
                    "@type": "ImageObject",
                    "width": 336,
                    "height": 188,
                    "url": "https://beccahughes.github.io/logo-dark-title-transparent.png",
                    "additionalProperty": {
                      "@type": "PropertyValue",
                      "name": "contentAttributes",
                      "value": ["forDarkBackground", "hasTitle", "transparentBackground"]
                    }
                  },
                  {
                    "@type": "ImageObject",
                    "width": 336,
                    "height": 188,
                    "url": "https://beccahughes.github.io/logo-light-title-transparent.png",
                    "additionalProperty": {
                      "@type": "PropertyValue",
                      "name": "contentAttributes",
                      "value": ["forLightBackground", "hasTitle", "transparentBackground"]
                    }
                  }
                ]
              },
              "additionalProperty": {
                "@type": "PropertyValue",
                "name": "cookieNameFilter",
                "value": "LOGIN"
              }
            }
          </code>
        </pre>
      </div>
    </section>

    <section id="media-feed-item">
      <h3>Media Feed Item</h2>

      <p>
        A <a>media feed document</a> may contain multiple
        <dfn>media feed items</dfn>. Each item represents a single item of media
        to be recommended to the user. Each <a>media feed item</a> must be one
        of the following <dfn>media item types</dfn>:

        <ul>
          <li>
            <a data-cite="schema-org/VideoObject#">
              Thing > CreativeWork > MediaObject > VideoObject
            </a>
          </li>
          <li>
            <a data-cite="schema-org/Movie#">
              Thing > CreativeWork > Movie
            </a>
          </li>
          <li>
            <a data-cite="schema-org/TVSeries#">
              Thing > CreativeWork > CreativeWorkSeries > TVSeries
            </a>
          </li>
        </ul>
      </p>

      <p>
        Every <a>media feed item</a> MUST have a <dfn>media item ID</dfn>
        that is unique within the <a>media feed document</a> and is a valid
        <a data-cite="url#urls">URL</a>.
      </p>

      <p>
        The user agent MUST validate every <a>media feed item</a> using the
        following steps:

        <ul>
          <li>
            The <a data-cite="json-ld11#specifying-the-type">type</a> MUST be
            set to a valid <a>media item type</a>.
          </li>
          <li>
            The <a data-cite="json-ld11#node-identifiers">@id</a> property MUST
            be set and contain a valid <a>media item ID</a>.
          </li>
          <li>
            The <a data-cite="schema-org/name#">name</a> property MUST contain
            a valid non-empty string.
          </li>
          <li>
            The <a data-cite="schema-org/datePublished#">datePublished</a>
            property MUST contain a string that is valid date or date time in
            <a data-cite="ISO8601#">ISO8601 format</a>.
          </li>
          <li>
            The <a data-cite="schema-org/image#">image</a> property supports
            <a>multiple values</a> and MUST contain a maximum of 5 different
            <a>media content images</a>.
          </li>
          <li>
            The <a data-cite="schema-org/potentialAction#">
            potentialAction</a> property MUST be a valid <a>media item
            action</a> unless the object has an <a>embedded watch action</a>
            OR the item is embedded in a <a>media feed broadcast event</a>.
          </li>
          <li>
            The <a data-cite="schema-org/interactionStatistic#">
            interactionStatistic</a> property supports <a>multiple values</a>
            and if present it MUST contain a maximum of 3
            <a>media item interaction statistics</a>.
          </li>
          <li>
            The <a data-cite="schema-org/contentRating#">
            contentRating</a> property supports <a>multiple values</a>
            and if present it MUST contain a maximum of 3 valid
            <a>media item content ratings</a>.
          </li>
          <li>
            The <a data-cite="schema-org/isFamilyFriendly#">isFamilyFriendly</a>
            property MAY be present. If present it MUST contain a
            <a>schema.org boolean property</a>.
          </li>
          <li>
            The <a data-cite="schema-org/genre#">genre</a> property supports
            <a>multiple values</a> and if present it MUST contain a maximum
            of 5 non-empty strings.
          </li>
          <li>
            The <a data-cite="schema-org/identifier#">identifier</a> property
            supports <a>multiple values</a> and if present it MUST contain
            a valid <a>media item third party identifier set</a>.
          </li>
          <li>
            If the <a>media item type</a> is a
            <a data-cite="schema-org/Movie#">Movie</a> then the user agent MUST
            also do the following:

            <ul>
              <li>
                The <a data-cite="schema-org/duration#">duration</a> property MUST
                contain a string that is valid duration in
                <a data-cite="ISO8601#">ISO8601 format</a>.
              </li>
            </ul>
          </li>
          <li>
            If the <a>media item type</a> is a
            <a data-cite="schema-org/VideoObject#">VideoObject</a> then the user
            agent MUST also do the following:

            <ul>
              <li>
                The <a data-cite="schema-org/author#">author</a> property MUST
                contain a valid <a>media item author</a>.
              </li>
              <li>
                The <a data-cite="schema-org/duration#">duration</a> property
                is only required if the item is embedded in a
                <a>media feed broadcast event</a> otherwise it is optional.
                If present, it MUST contain a string that is valid duration in
                <a data-cite="ISO8601#">ISO8601 format</a>.
              </li>
            </ul>
          </li>
          <li>
            If the <a>media item type</a> is a
            <a data-cite="schema-org/TVSeries#">TVSeries</a> then the user agent
            MUST also do the following:

            <ul>
              <li>
                The <a data-cite="schema-org/episode#">episode</a> property supports
                <a>multiple values</a> and if present it MUST contain valid
                <a>media item episodes</a>.
              </li>
              <li>
                The <a data-cite="schema-org/containsSeason#">containsSeason</a>
                property supports <a>multiple values</a> and if present it MUST
                contain valid <a>media item seasons</a>.
              </li>
            </ul>
          </li>
        </ul>
      </p>
    </section>

    <section id="media-feed-broadcast-event">
      <h3>Media Feed Broadcast Event</h2>

      <p>
        The <dfn>media feed broadcast event</dfn> describes a media
        recommendation that could be the broadcasting schedule of a show
        or a live streaming event on the internet. It contains an embedded
        <a>media feed item</a> that is the media recommendation that is
        being broadcast.
      </p>

      <p>
        <ul>
          The user agent MUST validate every <a>media feed broadcast event</a>
          using the following steps:

          <li>
            The <a data-cite="json-ld11#specifying-the-type">type</a> MUST be
            set to <a data-cite="schema-org/BroadcastEvent#">BroadcastEvent</a>.
          </li>
          <li>
            The <a data-cite="json-ld11#node-identifiers">@id</a> property MUST
            be set and contain a valid <a>media item ID</a>.
          </li>
          <li>
            The <a data-cite="schema-org/isLiveBroadcast#">isLiveBroadcast</a>
            property MUST contain a <a>schema.org boolean property</a>.
          </li>
          <li>
            The <a data-cite="schema-org/workPerformed#">workPerformed</a> property
            MUST contain a valid <a>media feed item</a>.
          </li>
          <li>
            The <a data-cite="schema-org/potentialAction#">
            potentialAction</a> property MUST be a valid <a>media item
            action</a> unless the object has an <a>embedded watch action</a>.
          </li>
          <li>
            The <a data-cite="schema-org/startDate#">startDate</a> property MUST
            contain a string that is valid date or date time in
            <a data-cite="ISO8601#">ISO8601 format</a>.
          </li>
          <li>
            The <a data-cite="schema-org/endDate#">endDate</a> property MAY
            be present. If it is, it MUST contain a string that is valid
            date or date time in <a data-cite="ISO8601#">ISO8601 format</a>.
          </li>
        </ul>
      </p>

      <div class="example" id="example-2-broadcast-event">
        <div class="marker">
            <a class="self-link" href="#example-2-broadcast-event">
              Example<bdi> 2</bdi>
            </a>
            <span class="example-title">: Broadcast Event</span>
        </div>

        <p>
          Below is an example of a video that is being live streamed.
        </p>

        <pre>
          <code class="json">
            {
              "@context": "https://schema.org/",
              "@type": "BroadcastEvent",
              "@id": "https://example.org/event",
              "isLiveBroadcast": "http://schema.org/True",
              "startDate": "2020-01-28T06:00:00+0000",
              "endDate": "2020-01-28T07:00:00+0000",
              "potentialAction": {
                "@type": "WatchAction",
                "target": "https://example.org/watch/video"
              },
              "workPerformed": {
                "@context": "https://schema.org/",
                "@type": "VideoObject",
                "@id": "https://example.org/video",
                "author": {
                  "@type": "Person",
                  "name": "Test User",
                  "url": "https://example.org/testuser"
                },
                "datePublished": "2020-01-27",
                "duration": "PT5M49S",
                "genre": "Animated Shorts",
                "image": {
                  "@type": "ImageObject",
                  "width": 360,
                  "height": 480,
                  "url": "https://example.org/video_thumbnail.png"
                },
                "interactionStatistic": {
                  "@type": "InteractionCounter",
                  "interactionType": "http://schema.org/WatchAction",
                  "userInteractionCount": "4356"
                },
                "isFamilyFriendly": "http://schema.org/True",
                "name": "Big Buck Bunny"
              }
            }
          </code>
        </pre>
      </div>
    </section>

    <section id="media-item-action">
      <h3>Media Item Action</h2>

        <p>
          The user agent MUST use the following steps to validate a <dfn>media
          item action</dfn>. The action contains the
          <dfn>media feed item url</dfn> which is used by the user agent to
          launch the media item.

          <ul>
            <li>
              The <a data-cite="json-ld11#specifying-the-type">type</a> MUST be
              set to <a data-cite="schema-org/WatchAction#">WatchAction</a>.
            </li>
            <li>
              The <a data-cite="schema-org/actionStatus#">actionStatus</a>
              property MAY be present. If present it MUST be one of the
              following:

              <ul>
                <li>
                  <a data-cite="schema-org/ActiveActionStatus#">
                    https://schema.org/ActiveActionStatus
                  </a> for when the action is in progress.
                </li>
                <li>
                  <a data-cite="schema-org/PotentialActionStatus#">
                    https://schema.org/PotentialActionStatus
                  </a> for when the action has not been started.
                </li>
                <li>
                  <a data-cite="schema-org/CompletedActionStatus#">
                    https://schema.org/CompletedActionStatus
                  </a> for when the action is finished.
                </li>
              </ul>
            </li>
            <li>
              If the <a data-cite="schema-org/actionStatus#">actionStatus</a>
              property is set to <a data-cite="schema-org/ActiveActionStatus#">
              https://schema.org/ActiveActionStatus</a>, then the
              <a data-cite="schema-org/startTime#">startTime</a> property MUST
              contain a valid <a data-cite="xmlschema-2#time">time</a>.
            </li>
            <li>
              The <a data-cite="schema-org/target#">target</a> property MUST
              contain a valid <a data-cite="url#urls">URL</a>.
            </li>
          </ul>
        </p>
    </section>

    <section id="media-item-content-rating">
      <h3>Media Item Content Rating</h2>

        <p>
          The <dfn>content rating</dfn> rates the suitability of the <a>media
          feed item</a> to its audience. It is usually a category that tells
          which age group is suitable to view the media.
        </p>

        <p>
          The <dfn>media item content rating</dfn> can be a non-empty string
          containing the <a>content rating</a> of the media item. It can also
          be a <a data-cite="schema-org/Rating#">Rating</a>. If it is a
          <a data-cite="schema-org/Rating#">Rating</a> then the user
          agent MUST use the following steps to validate it:

          <ul>
            <li>
              The <a data-cite="json-ld11#specifying-the-type">type</a> MUST be
              set to <a data-cite="schema-org/Rating#">Rating</a>.
            </li>
            <li>
              The <a data-cite="schema-org/author#">author</a> property MUST
              contain a valid non-empty string. This is the agency that issued
              the rating (e.g. MPAA). A list of known content rating agencies
              is <a href="content-rating-agencies.md">available here</a>.
            </li>
            <li>
              The <a data-cite="schema-org/ratingValue#">ratingValue</a>
              property MUST contain a valid non-empty string. This is the
              <a>content rating</a> that was issued.
            </li>
          </ul>
        </p>
    </section>

    <section id="media-item-interaction-statistic">
      <h3>Media Item Interaction Statistic</h2>

        <p>
          The <dfn>media item interaction statistic</dfn> is a counter that
          counts how many interactions of a certain type (e.g. likes, views)
          that a <a>media feed item</a> has. There can be at most one
          <a>media item interaction statistic</a> for a certain type for a
          single <a>media feed item</a>.
        </p>

        <p>
          The user agent MUST use the following steps to validate it:

          <ul>
            <li>
              The <a data-cite="json-ld11#specifying-the-type">type</a> MUST be
              set to <a data-cite="schema-org/InteractionCounter#">
              InteractionCounter</a>.
            </li>
            <li>
              The <a data-cite="schema-org/interactionType#">interactionType</a>
              property MUST be unique within a <a>media feed item</a> and be
              one of the following:

              <ul>
                <li>
                  <a data-cite="schema-org/WatchAction#">
                    https://schema.org/WatchAction
                  </a> for how many views this <a>media feed item</a> has.
                </li>
                <li>
                  <a data-cite="schema-org/LikeAction#">
                    https://schema.org/LikeAction
                  </a> for how many likes this <a>media feed item</a> has.
                </li>
                <li>
                  <a data-cite="schema-org/DislikeAction#">
                    https://schema.org/DislikeAction
                  </a> for how many dislikes this <a>media feed item</a> has.
                </li>
              </ul>
            </li>
            <li>
              The <a data-cite="schema-org/userInteractionCount#">
              userInteractionCount</a> property MUST contain a number. This can
              be either a JSON number or a string. This is the count of the
              interactions that happened.
            </li>
          </ul>
        </p>
    </section>

    <section id="media-item-author">
      <h3>Media Item Author</h2>

        <p>
          The <dfn>media item author</dfn> can be a non-empty string containing
          the name of the author. It can also be a
          <a data-cite="schema-org/Person#">Person</a>. If it is a
          <a data-cite="schema-org/Person#">Person</a> then the user
          agent MUST use the following steps to validate it:
  
          <ul>
            <li>
              The <a data-cite="json-ld11#specifying-the-type">type</a> MUST be
              set to <a data-cite="schema-org/Person#">Person</a>.
            </li>
            <li>
              The <a data-cite="schema-org/name#">name</a> property MUST contain a
              valid non-empty string.
            </li>
            <li>
              The <a data-cite="schema-org/url#">url</a> property MAY be present
              If present, it MUST contain a valid
              <a data-cite="url#urls">URL</a>.
            </li>
          </ul>
        </p>
    </section>

    <section id="media-item-season">
      <h3>Media Item Season</h2>

        <p>
          The <dfn>media item season</dfn> represents a season of TV episodes.
        </p>

        <p>
          The user agent MUST use the following steps to validate it:

          <ul>
            <li>
              The <a data-cite="json-ld11#specifying-the-type">type</a> MUST be
              set to <a data-cite="schema-org/TVSeason#">TVSeason</a>.
            </li>
            <li>
              The <a data-cite="schema-org/seasonNumber#">
              seasonNumber</a> property MUST be a positive integer.
            </li>
            <li>
              The <a data-cite="schema-org/numberOfEpisodes#">
              numberOfEpisodes</a> property MUST be a positive integer.
            </li>
            <li>
              The <a data-cite="schema-org/episode#">episode</a> property supports
              <a>multiple values</a> and if present it MUST contain valid
              <a>media item episodes</a>.
            </li>
          </ul>
        </p>
    </section>

    <section id="media-item-episode">
      <h3>Media Item Episode</h2>

        <p>
          The <dfn>media item episode</dfn> represents a single TV episode. It
          contains an <dfn>embedded watch action</dfn> stored in the
          <a data-cite="schema-org/potentialAction#">potentialAction</a>
          property.
        </p>

        <p>
          The user agent MUST use the following steps to validate it:

          <ul>
            <li>
              The <a data-cite="json-ld11#specifying-the-type">type</a> MUST be
              set to <a data-cite="schema-org/TVEpisode#">TVEpisode</a>.
            </li>
            <li>
              The <a data-cite="schema-org/episodeNumber#">
              episodeNumber</a> property MUST be a positive integer.
            </li>
            <li>
              The <a data-cite="schema-org/duration#">duration</a> property MUST
              contain a string that is a valid duration in
              <a data-cite="ISO8601#">ISO8601 format</a>.
            </li>
            <li>
              The <a data-cite="schema-org/name#">name</a> property MAY be
              present. If present, it MUST contain a valid non-empty string.
            </li>
            <li>
              The <a data-cite="schema-org/identifier#">identifier</a> property
              supports <a>multiple values</a> and if present it MUST contain
              a valid <a>media item third party identifier set</a>.
            </li>
            <li>
              The <a data-cite="schema-org/image#">image</a> property supports
              <a>multiple values</a> and if present it MUST contain a maximum
              of 5 valid <a>media content images</a>.
            </li>
            <li>
              The <a data-cite="schema-org/potentialAction#">
              potentialAction</a> property MUST contain a valid
              <a>media item action</a>.
            </li>
          </ul>
        </p>
    </section>

    <section id="media-image">
      <h3>Media Image</h2>

      <p>
        The <dfn>media image</dfn> represents an image that can be a
        thumbnail that represents the content or it could be the logo
        for the feed. It has a number of <dfn>content attributes</dfn>
        that describe the image's type and defines its suggested usages.
        Depending on where the <a>media image</a> is embedded there are
        different requirements for <a>content attributes</a>.
      </p>

      <p>
        The user agent MUST use the following steps to validate it:

        <ul>
          <li>
            The <a data-cite="json-ld11#specifying-the-type">type</a> MUST be
            set to <a data-cite="schema-org/ImageObject#">ImageObject</a>.
          </li>
          <li>
            The <a data-cite="schema-org/width#">width</a> property MUST
            contain a positive integer that is the width of the image in
            pixels.
          </li>
          <li>
            The <a data-cite="schema-org/height#">height</a> property MUST
            contain a positive integer that is the height of the image in
            pixels.
          </li>
          <li>
            The <a data-cite="schema-org/embedUrl#">embedUrl</a> property or
            <a data-cite="schema-org/url#">url</a> property MUST contain
            a valid <a data-cite="url#urls">URL</a>.
          </li>
          <li>
            The <a data-cite="schema-org/additionalProperty#">additionalProperty</a>
            property MAY be present. If present, it must contain a
            <a data-cite="schema-org/PropertyValue#">PropertyValue</a> object and
            the user agent MUST use the following steps to validate it:

            <ul>
              <li>
                The <a data-cite="json-ld11#specifying-the-type">type</a> MUST be
                set to <a data-cite="schema-org/PropertyValue#">PropertyValue</a>.
              </li>
              <li>
                The <a data-cite="schema-org/name#">name</a> property MUST contain
                <code>contentAttributes</code>.
              </li>
              <li>
                The <a data-cite="schema-org/value#">value</a> property supports
                <a>multiple values</a> and if present it MUST contain non empty
                strings. These are the <a>content attributes</a> for the
                <a>media image</a>.
              </li>
            </ul>
          </li>
        </ul>
      </p>

      <p>
        A <dfn>media logo</dfn> is a <a>media image</a> that is the logo for the
        website providing the feed. The following <a>content attributes</a> are
        required for the logo to be valid:

        <ul>
          <li>
            One <a>background suitability</a> attribute.
          </li>
          <li>
            One <a>title</a> attribute.
          </li>
          <li>
            Optionally, a <a>predominant figure position</a> attribute.
          </li>
          <li>
            Optionally, the <a>transparent background</a> attribute.
          </li>
        </ul>
      </p>

      <p>
        A <dfn>media content image</dfn> is a <a>media image</a> that is the
        thumbnail or poster for the media. The <a>media content image</a>
        does not require any <a>content attributes</a> to be valid, but it
        does support the following:

        <ul>
          <li>
            Optionally, a <a>content type</a> attribute.
          </li>
          <li>
            Optionally, a <a>recommended use</a> attribute.
          </li>
          <li>
            Optionally, a <a>title</a> attribute.
          </li>
          <li>
            Optionally, a <a>background suitability</a> attribute.
          </li>
          <li>
            Optionally, a <a>predominant figure position</a> attribute.
          </li>
          <li>
            Optionally, the <a>transparent background</a> attribute.
          </li>
        </ul>
      </p>

      <p>
        A <dfn>content type</dfn> attribute indicates to the user agent what
        type of content the <a>media image</a> contains. There can only ever
        be one <a>content type</a> <a>content attribute</a> per image.
        The attributes are defined as the following:

        <ul>
          <li>
            <code>iconic</code>: The image is an artistic render of the show.
            This is usually a poster or banner.
          </li>
          <li>
            <code>sceneStill</code>: The image is a still/framegrab from the
            media item.
          </li>
        </ul>
      </p>

      <p>
        A <dfn>recommended use</dfn> attribute indicates to the user agent 
        where the <a>media image</a> can be used. There can only ever
        be one <a>recommended use</a> <a>content attribute</a> per image.
        The attributes are defined as the following:

        <ul>
          <li>
            <code>poster</code>: The image is a poster image for the show.
          </li>
          <li>
            <code>background</code>: This image is suitable for being used as
            a background and does not contain text.
          </li>
        </ul>
      </p>

      <figure id="content-attributes-example">
        <figcaption>
          The image on the left would have the <code>iconic</code>,
          <code>poster</code> and <code>hasTitle</code> attributes.
          The image on the right would have the <code>sceneStill</code>,
          <code>background</code> and <code>noTitle</code> attributes.
        </figcaption>
        <img src="images/content_type.png" />
      </figure>

      <p>
        A <dfn>background suitability</dfn> attribute indicates to the user agent
        whether the <a>media image</a> is suitable for display on different
        backgrounds. This is important for images that have a transparent
        background. There can only ever be one <a>background suitability</a>
        <a>content attribute</a> per image. The attributes are defined as the 
        following:

        <ul>
          <li>
            <code>forDarkBackground</code>: The image is suitable for use on a
            dark background.
          </li>
          <li>
            <code>forLightBackground</code>: The image is suitable for use on a
            light background.
          </li>
        </ul>
      </p>

      <p>
        A <dfn>title</dfn> attribute indicates to the user agent whether the
        <a>media image</a> has a title included with the image. This is
        important for images that are logos that might be an icon or an icon
        with a title. There can only ever be one <a>title</a>
        <a>content attribute</a> per image. The attributes are defined as the 
        following:

        <ul>
          <li>
            <code>hasTitle</code>: The image includes the title of the media
            item or website.
          </li>
          <li>
            <code>noTitle</code>: The image does not include the title.
          </li>
        </ul>
      </p>

      <p>
        The <dfn>transparent background</dfn> attribute indicates to the user
        agent that the <a>media image</a> has a transparent background. This
        is usually used for images that are the logo of the website. If this 
        is the case the <code>transparentBackground</code>
        <a>content attribute</a> should be present.
      </p>

      <p>
        A <dfn>predominant figure position</dfn> attribute indicates to the
        user agent where the predominant figure of the image is positioned in
        the <a>media image</a>. There can only ever be one
        <a>predominant figure position</a> <a>content attribute</a> per image.
        The attributes are defined as the following:

        <ul>
          <li>
            <code>centered</code>: The predominant figure is positioned at
            the center of the image.
          </li>
          <li>
            <code>rightCentered</code>: The predominant figure is positioned
            to the right of the image and the left side is empty and can
            be used for text overlays.
          </li>
          <li>
            <code>leftCentered</code>: The predominant figure is positioned
            to the left of the image and the left side is empty and can
            be used for text overlays.
          </li>
        </ul>
      </p>
    </section>

    <section id="media-item-identifier">
      <h3>Media Item Identifier</h2>

        <p>
          A <dfn>media item third party identifier</dfn> is an identifier for the
          <a>media feed item</a> in a third-party system. The user agent can use
          it to cross reference the  <a>media feed item</a> with media data stored
          in other systems.
        </p>

        <p>
          The <dfn>third party identifier name</dfn> identifies the type of the
          third-party identifier and these are left up to the implementation. A 
          list of known identifiers is <a href="third-party-identifiers.md">
          available here</a>.
        </p>
        
        <p>
          The <dfn>media item third party identifier set</dfn> is a set of
          <a>media item third party identifiers</a> that contain at most one 
          identifier per <a>third party identifier name</a> for a single
          <a>media feed item</a>. Any duplicates MAY be ignored by the user
          agent.
        </p>

        <p>
          The user agent MUST use the following steps to validate the
          <a>media item third party identifier</a>:

          <ul>
            <li>
              The <a data-cite="json-ld11#specifying-the-type">type</a> MUST be
              set to <a data-cite="schema-org/PropertyValue#">PropertyValue</a>.
            </li>
            <li>
              The <a data-cite="schema-org/propertyID#">propertyID</a> property
              contains the <a>third party identifier name</a> which MUST be a
              non-empty string.
            </li>
            <li>
              The <a data-cite="schema-org/value#">value</a> property MUST
              contain a non-empty string.
            </li>
          </ul>
        </p>
    </section>
  </section>

  <section id="retrieval-of-common-properties">
    <h2>Retrieval of Common Properties</h2>

    <p>
      This section describes how a user agent MUST validate different schema.org
      property types.
    </p>

    <section id="boolean-retrieval">
      <h3>Boolean</h3>

      <p>
        The user agent MUST use the following steps to convert a <dfn>schema.org
        boolean property</dfn> into a normal boolean:

        <ul>
          <li>
            If the property is a <a data-cite="JSON#">JSON boolean</a> type,
            then return the value
          </li>
          <li>
            If the property is a <a data-cite="JSON#">JSON string</a> type then:

            <ul>
              <li>
                If the string value equals <code>https://schema.org/True</code>,
                then return true
              </li>
              <li>
                If the string value equals <code>https://schema.org/False</code>,
                then return false
              </li>
            </ul>
          </li>
          <li>
            Otherwise, return an error
          </li>
        </ul>
      </p>
    </section>

    <section id="multiple-values">
      <h3>Multiple Values</h3>

      <p>
        If the property supports <dfn>multiple values</dfn> then the values
        for the property MUST be wrapped in an array. If there is only one
        value then it MAY be embedded directly. If there is a maximum
        number of values supported by a <a>multiple value</a> property then
        these MAY be ignored by the user agent.
      </p>

      <div class="example" id="example-3-multiple-values">
        <div class="marker">
            <a class="self-link" href="#example-3-multiple-values">
              Example<bdi> 3</bdi>
            </a>
            <span class="example-title">: Multiple Values</span>
        </div>

        <p>
          If there are multiple values for a property then a JSON array
          can be used. For example with the <code>genre</code>
          property example below their are two genres specified:
        </p>

        <pre>
          <code class="json">
            {
              "@context": "https://schema.org/",
              "@type": "VideoObject",
              ...

              "genre": {
                "Action",
                "Comedy"
              },

              ...
            }
          </code>
        </pre>

        <p>
          If there is only one value it can be embedded directly in the
          property without needing an array.
        </p>

        <pre>
          <code class="json">
            {
              "@context": "https://schema.org/",
              "@type": "VideoObject",
              ...

              "genre": "Action",

              ...
            }
          </code>
        </pre>
      </div>
    </section>
  </section>

  <section id="continue-watching">
    <h2>Continue Watching</h2>

    <p>
      A user agent might want to display content for the user to continue
      watching. In this case the <a>media item action</a> can have the
      <a data-cite="schema-org/ActiveActionStatus#">
      https://schema.org/ActiveActionStatus</a> to indicate this.
    </p>

    <div class="example" id="example-3-continue-watching">
      <div class="marker">
          <a class="self-link" href="#example-3-continue-watching">
            Example<bdi> 3</bdi>
          </a>
          <span class="example-title">: Continue Watching</span>
      </div>
      <pre>
        <code class="json">
          {
            "@context": "https://schema.org/",
            "@type": "VideoObject",
            ...

            "potentialAction": {
              "@type": "WatchAction",
              "actionStatus": "http://schema.org/ActiveActionStatus",
              "startTime": "00:00:10",
              "target": "https://example.org/video?time=10s"
            },

            ...
          }
        </code>
      </pre>
    </div>
  </section>

  <section id="play-next-tv-episodes">
    <h2>Play Next and TV Episodes</h2>

    <p>
      A <a>media feed item</a> that is a TV series can have up to two TV
      episodes embedded in it. These can be embedded directly in the
      <a>media feed item</a> or embedded within a <a>media item season</a>.
      If there are more than two episodes they will be ignored.
    </p>

    <p>
      The user agent MUST use the following steps to calculate the
      <dfn>main TV episode</dfn>:

      <ul>
        <li>
          If there are no <a>media item episodes</a> embedded in the
          <a>media feed item</a>, then return null
        </li>
        <li>
          If there is one <a>media item episode</a> embedded in the
          <a>media feed item</a>, then return that
        </li>
        <li>
          If there is more than one <a>media item episode</a> embedded in the
          <a>media feed item</a>, then add them to <var>candidates</var>
        </li>
        <li>
          Remove any <var>candidates</var> which do not have a
          <a>media item action</a> with either a
          <a data-cite="schema-org/CompletedActionStatus#">
          https://schema.org/CompletedActionStatus</a> or
          <a data-cite="schema-org/ActiveActionStatus#">
          https://schema.org/ActiveActionStatus</a>
        </li>
        <li>
          Sort the remaining <var>candidates</var> by
          <a data-cite="schema-org/seasonNumber#">seasonNumber</a> and then
          <a data-cite="schema-org/episodeNumber#">episodeNumber</a> in a
          descending order
        </li>
        <li>
          Return the first item in <var>candidates</var> or null if it is empty
        </li>
      </ul>
    </p>

    <p>
      A user agent might want to display the next episode in a TV series to play
      next. In this case, the user agent should calculate the
      <dfn>play next episode</dfn> using the following algorithm:
    </p>

    <p>
      <ul>
        <li>
          If the <a>main TV episode</a> is null, then return null
        </li>
        <li>
          For each <a>media item episode</a> embedded in the
          <a>media feed item</a>, add it to <var>candidates</var>
        </li>
        <li>
          Remove any <var>candidates</var> which do not have a
          <a>media item action</a> with a
          <a data-cite="schema-org/PotentialActionStatus#">
          https://schema.org/PotentialActionStatus</a>
        </li>
        <li>
          Let <var>next episode number</var> be the <var>main TV episode</var>
          number plus 1
        </li>
        <li>
          Let <var>next season number</var> be the <var>main TV episode</var>
          season number
        </li>
        <li>
          If the <var>next episode number</var> is greater than the
          <a data-cite="schema-org/numberOfEpisodes#">numberOfEpisodes</a>
          in the season; then set <var>next episode number</var> to 1 and
          increment the <var>next season number</var> by 1
        </li>
        <li>
          Find the <a>media item episode</a> in <var>candidates</var> which
          has the <a data-cite="schema-org/episodeNumber#">episodeNumber</a>
          equal to <var>next epsiode number</var> and the
          <a data-cite="schema-org/seasonNumber#">
          seasonNumber</a> equal to <var>next season number</var>.
          If there is no matching <a>media item episode</a> return null
        </li>
      </ul>
    </p>
  </section>

  <section>
    <h2 id="iana">IANA Considerations</h2>

    <h3 id="iana-well-known">Well-known <code>media-feeds</code> URI</h3>

    <p>
      This section provides the provisional registration of the
      <dfn><code>media-feeds</code> well-known URI</dfn> in the Well-Known URIs
      registry in accordance with
      <a data-cite="RFC8615#">Well-Known Uniform Resource Identifiers (URIs)</a>.
    </p>

    <p class="note">
      Although the rest of this specification, and indeed the rest of the web platform,
      <a href="https://url.spec.whatwg.org/#url-apis-elsewhere">uses the term "URL"</a>,
      this section in particular intersects with a community that uses the term "URI".
    </p>

    <dl>
      <dt><strong>URI suffix</strong></dt>
      <dd><code>media-feeds</code></dd>

      <dt><strong>Change controller</strong></dt>
      <dd><code>WICG</code></dd>

      <dt><strong>Specification document(s)</strong></dt>
      <dd><a href="https://wicg.github.io/media-feeds/">https://wicg.github.io/media-feeds/</a></dd>

      <dt><strong>Related information</strong></dt>
      <dd>N/A</dd>
    </dl>
  </section>
</body>

</html>
